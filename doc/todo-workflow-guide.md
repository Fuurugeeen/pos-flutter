# TODO ワークフロー ガイド

このドキュメントでは、プロジェクトの TODO 管理ワークフローと、カスタムコマンドの使用方法を説明します。

## 概要

プロジェクトでは、以下の2つのファイルを使用して TODO を管理します：

- **doc/todo-tmp.md**: 一時的な修正指示やアイデアを記録
- **doc/todo.md**: 正式な TODO リスト（実装対象）

## ワークフロー

### 1. 一時メモの作成（todo-tmp.md）

作業中に思いついた修正点や改善案を `doc/todo-tmp.md` に記録します。

```markdown
# TODO 一時メモ

## 2025-10-29
- [ ] 顧客検索のパフォーマンスを改善する
- [ ] レポート画面のレイアウトを修正
- [ ] テストカバレッジを80%以上にする
```

### 2. TODO リストへの統合（sync-todos）

一時メモを正式な TODO リストに統合します。

#### コマンド実行

```bash
/sync-todos
```

このコマンドは以下を実行します：
1. `todo-tmp.md` の内容を読み取る
2. `todo.md` に項目を追加または更新
3. `todo-tmp.md` の項目に完了マークを付ける
4. 整合性を確認

#### 実行後の状態

**todo-tmp.md**
```markdown
# TODO 一時メモ

## 2025-10-29 ✅ 完了: 2025-10-29 17:00
- [x] 顧客検索のパフォーマンスを改善する
- [x] レポート画面のレイアウトを修正
- [x] テストカバレッジを80%以上にする
```

**todo.md**
```markdown
# TODO リスト

## 優先度: 高
- [ ] 顧客検索のパフォーマンスを改善する
  - 関連ファイル: lib/features/customer/repositories/customer_repository.dart
  - 実施内容: インデックスを追加、クエリを最適化

## 優先度: 中
- [ ] レポート画面のレイアウトを修正
  - 関連ファイル: lib/features/reports/screens/reports_screen.dart
  - 実施内容: レスポンシブデザインの改善

## 優先度: 低
- [ ] テストカバレッジを80%以上にする
  - 関連ファイル: test/ 配下全体
  - 実施内容: 不足しているテストケースを追加
```

### 3. TODO の実施（apply-todos）

TODO リストの項目を実際に実装します。

#### コマンド実行

```bash
/apply-todos
```

このコマンドは以下を実行します：
1. `todo.md` から未完了の項目を取得
2. 各項目を順次実装
3. コードの検証（analyze, test）
4. 変更をコミット
5. TODO を完了済みに更新

#### 実行後の状態

**todo.md**
```markdown
# TODO リスト

## 完了済み（2025-10-29）
- [x] 顧客検索のパフォーマンスを改善する
  - コミット: a1b2c3d
  - 完了日時: 2025-10-29 17:30
  - 実施内容: インデックスを追加、クエリを最適化
```

### 4. 一括実行（process-todos）

ステップ2と3を一括で実行します。

#### コマンド実行

```bash
/process-todos
```

このコマンドは `sync-todos` と `apply-todos` を順次実行します。

## コマンドリファレンス

### /sync-todos

一時メモ（todo-tmp.md）を正式な TODO リスト（todo.md）に統合します。

**使用タイミング:**
- 一時メモが溜まってきたとき
- TODO リストを整理したいとき
- 定期的なレビュー時

**オプション:**
なし（自動で全項目を処理）

### /apply-todos

TODO リスト（todo.md）の項目を実装します。

**使用タイミング:**
- TODO を実装する準備ができたとき
- まとまった時間が取れるとき

**オプション:**
なし（自動で全項目を処理）

**注意事項:**
- テストが失敗した項目は完了済みにしません
- エラーが発生した場合は処理を中断します
- 各変更は個別にコミットされます

### /process-todos

sync-todos と apply-todos を一括実行します。

**使用タイミング:**
- 一時メモの統合から実装まで一気に実施したいとき
- 定期的なメンテナンス時

**オプション:**
なし（自動で全処理を実行）

**注意事項:**
- 途中でエラーが発生した場合、その時点で中断します
- 大量の TODO がある場合、処理に時間がかかる可能性があります

## ベストプラクティス

### 1. 一時メモは頻繁に書く

思いついたアイデアや改善点は、すぐに `todo-tmp.md` に記録しましょう。

```markdown
# TODO 一時メモ

## 2025-10-29 午前
- [ ] ログイン画面のボタンサイズを統一
- [ ] エラーメッセージを日本語化

## 2025-10-29 午後
- [ ] データベースのバックアップスクリプト作成
```

### 2. 定期的に統合する

週に1回程度、`/sync-todos` を実行して TODO リストを整理しましょう。

### 3. TODO は具体的に書く

実装者（あなた自身や Claude）が理解しやすいように、具体的な情報を含めましょう。

**良い例:**
```markdown
- [ ] 顧客検索のパフォーマンスを改善する
  - 関連ファイル: lib/features/customer/repositories/customer_repository.dart:45
  - 問題: 検索に3秒以上かかる
  - 解決策: インデックスを追加、キャッシュを実装
```

**悪い例:**
```markdown
- [ ] 検索を速くする
```

### 4. 優先度を設定する

TODO には優先度を設定し、重要なものから実施しましょう。

```markdown
## 優先度: 高（今週中）
- [ ] セキュリティの脆弱性を修正

## 優先度: 中（今月中）
- [ ] UI の改善

## 優先度: 低（時間があれば）
- [ ] コードのリファクタリング
```

### 5. 完了した TODO は削除しない

完了した TODO は「完了済み」セクションに移動し、履歴として保持しましょう。

```markdown
## 完了済み（2025-10）
- [x] 顧客検索のパフォーマンスを改善する（2025-10-29）
- [x] レポート画面のレイアウトを修正（2025-10-28）
```

## トラブルシューティング

### コマンドが見つからない

Claude Code を再起動してください。`.claude/commands/` ディレクトリのファイルは起動時に読み込まれます。

### TODO が完了済みにならない

- テストが失敗していないか確認してください
- コンパイルエラーがないか確認してください
- `flutter analyze` でエラーがないか確認してください

### 途中でエラーが発生した

- エラーメッセージを確認し、問題を修正してください
- 必要に応じて手動で TODO を更新してください
- 再度コマンドを実行してください（冪等性があります）

## 関連ドキュメント

- [CLAUDE.md](../CLAUDE.md): プロジェクト全体のガイドライン
- [development-todo.md](./development-todo.md): 開発中の TODO リスト
- [system-specification.md](./system-specification.md): システム仕様書

## 更新履歴

- 2025-10-29: 初版作成
